import React, { useState, useEffect } from 'react'
import './URLListStyle.css'

function URLList(props) {
    const { data, loadList, countLoad } = props;

    useEffect(() => {
        console.log('reloaded')
        loadList();
        console.log('after loadList')
    }, [countLoad]);

    const searchTerm = props.searchText;
    const handleColor = (result) => {
        if (result == 'mal') {
            return 'rgba(255, 99, 71, 0.5)';
        } else if (result == 'sus') {
            return 'rgba(204, 255, 0, 0.5)';
        } else {
            return 'rgba(255, 174, 71, 0.7)';
        }
    }

    const searchResults = data ? Object.entries(data)
        .filter(([key, entry]) =>
            entry.url.includes(searchTerm) || entry.url.toLowerCase().includes(searchTerm.toLowerCase()))
        .map(([key, entry]) => (
            <li key={key} style={{
                backgroundColor: handleColor(entry.result),
                borderBottom: `10px solid ${handleColor(entry.result).slice(0, -4) + "1)"}`,
            }}>
                URL: {entry.url} <br />
                Timestamp: {entry.timestamp} <br />
                Result: {entry.result}
            </li>
        )) : null;


    return (
        <div className='ul-container'>
            {(!searchResults || searchResults.length === 0) ? (
                <h1>Empty as space itself</h1>
            ) : (
                <ul>{searchResults}</ul>
            )}
        </div>
    );


}

export default URLList
